<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tag Management Center</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                },
            },
        }
    </script>
    <style>
        /* Initial states to prevent flash */
        .main-content {
            opacity: 0;
        }

        .header-content {
            opacity: 0;
        }

        /* Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        .animate-fade-in {
            animation: fadeIn 300ms ease-out forwards;
        }

        .animate-fade-in-header {
            animation: fadeIn 300ms ease-out forwards;
        }

        @media (prefers-reduced-motion: reduce) {
            .animate-fade-in, .animate-fade-in-header {
                animation: none;
                opacity: 1;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Top Bar -->
    <div class="bg-white shadow">
        <div class="max-w-[1280px] mx-auto h-[120px] flex items-center px-4">
            <div class="header-content animate-fade-in-header">
                <a href="index.html" class="flex items-center gap-2 text-2xl font-normal text-gray-600 hover:text-gray-800 transition-colors duration-150">
                    <i class="fa-solid fa-arrow-left text-xl"></i>
                    <span>Back</span>
                </a>
            </div>
        </div>
    </div>
    
    <!-- Tag Administration Section -->
    <div class="px-8 pt-8 pb-4 max-w-[1280px] mx-auto main-content animate-fade-in">
        <!-- Header Section -->
        <div class="breadcrumb-container mb-8">
            <div class="flex items-center justify-between">
                <div class="title">
                    <h1 class="text-[32px] leading-[36px] font-normal text-[#101114] flex items-center m-0 mr-[15px] break-all">Tags</h1>
                </div>
                <button type="button" 
                    class="flex items-center justify-center gap-2 rounded text-xs leading-5 font-medium tracking-[1px] uppercase text-white bg-[#1ec71e] hover:bg-[#1ab01a] active:bg-[#158515] px-4 py-2.5 h-10 cursor-pointer border-none"
                    onclick="openCreateTagModal()">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 448 512">
                        <path d="M256 80c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 144L48 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l144 0 0 144c0 17.7 14.3 32 32 32s32-14.3 32-32l0-144 144 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-144 0 0-144z"></path>
                    </svg>
                    Create tag
                </button>
            </div>
        </div>

        <!-- Search Box -->
        <div class="mb-4">
            <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                    <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </div>
                <input type="text" 
                    class="w-full pl-12 pr-4 py-3 bg-white border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" 
                    placeholder="Search tags"
                    oninput="filterTags(this.value)">
            </div>
        </div>

        <!-- Tags Table -->
        <div class="bg-white rounded-lg shadow-md">
            <table class="min-w-full">
                <thead>
                    <tr class="border-b">
                        <th class="w-12 py-3 px-4">
                            <input type="checkbox" class="rounded border-gray-300">
                        </th>
                        <th class="text-left py-3 px-4 text-sm font-medium">
                            <button class="flex items-center gap-1 hover:text-gray-600" onclick="sortTable(1, 'text')">
                                Name
                                <svg class="w-4 h-4 sort-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l4-4 4 4m0 6l-4 4-4-4"></path>
                                </svg>
                            </button>
                        </th>
                        <th class="text-left py-3 px-4 text-sm font-medium">
                            <button class="flex items-center gap-1 hover:text-gray-600" onclick="sortTable(2, 'number')">
                                Objects Count
                                <svg class="w-4 h-4 sort-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l4-4 4 4m0 6l-4 4-4-4"></path>
                                </svg>
                            </button>
                        </th>
                        <th class="text-left py-3 px-4 text-sm font-medium">
                            <button class="flex items-center gap-1 hover:text-gray-600" onclick="sortTable(3, 'text')">
                                Creator
                                <svg class="w-4 h-4 sort-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l4-4 4 4m0 6l-4 4-4-4"></path>
                                </svg>
                            </button>
                        </th>
                        <th class="text-left py-3 px-4 text-sm font-medium">
                            <button class="flex items-center gap-1 hover:text-gray-600" onclick="sortTable(4, 'date')">
                                Last Updated
                                <svg class="w-4 h-4 sort-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 9l4-4 4 4m0 6l-4 4-4-4"></path>
                                </svg>
                            </button>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Data rows with dummy data - reduced to 7 tags -->
                    <tr class="border-b hover:bg-gray-50 group">
                        <td class="py-3 px-4"><input type="checkbox" class="rounded border-gray-300"></td>
                        <td class="py-3 px-4">
                            <div class="flex items-center gap-2">
                                <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-md text-xs">#data-lineage</span>
                            </div>
                        </td>
                        <td class="py-3 px-4">1,247</td>
                        <td class="py-3 px-4">
                            <div class="relative">
                                <a href="#" class="text-blue-600 hover:text-blue-800 hover:underline">Sarah Chen</a>
                            </div>
                        </td>
                        <td class="py-3 px-4">Feb 14, 2024 15:30</td>
                        <td class="w-0 p-0 relative">
                            <div class="absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-150">
                                <button class="p-1 hover:bg-gray-100 rounded-full" onclick="toggleDropdown(event, this)">
                                    <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 14a2 2 0 100-4 2 2 0 000 4zM19 14a2 2 0 100-4 2 2 0 000 4zM5 14a2 2 0 100-4 2 2 0 000 4z"></path>
                                    </svg>
                                </button>
                                <div class="hidden absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg border z-50 dropdown-menu">
                                    <ul class="py-1" role="menu">
                                        <li role="presentation">
                                            <button class="w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="openEditTagModal(this)">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path>
                                                </svg>
                                                Edit tag
                                            </button>
                                        </li>
                                        <li role="presentation">
                                            <button class="w-full px-4 py-2 text-sm text-red-600 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="deleteTag(this)">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                                Delete tag
                                            </button>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr class="border-b hover:bg-gray-50 group">
                        <td class="py-3 px-4"><input type="checkbox" class="rounded border-gray-300"></td>
                        <td class="py-3 px-4">
                            <div class="flex items-center gap-2">
                                <span class="bg-green-100 text-green-800 px-2 py-1 rounded-md text-xs">#data-quality</span>
                            </div>
                        </td>
                        <td class="py-3 px-4">836</td>
                        <td class="py-3 px-4">
                            <div class="relative">
                                <a href="#" class="text-blue-600 hover:text-blue-800 hover:underline">Emma Wilson</a>
                            </div>
                        </td>
                        <td class="py-3 px-4">Jan 28, 2024 09:15</td>
                        <td class="w-0 p-0 relative">
                            <div class="absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-150">
                                <button class="p-1 hover:bg-gray-100 rounded-full" onclick="toggleDropdown(event, this)">
                                    <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 14a2 2 0 100-4 2 2 0 000 4zM19 14a2 2 0 100-4 2 2 0 000 4zM5 14a2 2 0 100-4 2 2 0 000 4z"></path>
                                    </svg>
                                </button>
                                <div class="hidden absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg border z-50 dropdown-menu">
                                    <ul class="py-1" role="menu">
                                        <li role="presentation">
                                            <button class="w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="openEditTagModal(this)">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path>
                                                </svg>
                                                Edit tag
                                            </button>
                                        </li>
                                        <li role="presentation">
                                            <button class="w-full px-4 py-2 text-sm text-red-600 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="deleteTag(this)">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                                Delete tag
                                            </button>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr class="border-b hover:bg-gray-50 group">
                        <td class="py-3 px-4"><input type="checkbox" class="rounded border-gray-300"></td>
                        <td class="py-3 px-4">
                            <div class="flex items-center gap-2">
                                <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded-md text-xs">#metadata-management</span>
                            </div>
                        </td>
                        <td class="py-3 px-4">2,156</td>
                        <td class="py-3 px-4">
                            <div class="relative">
                                <a href="#" class="text-blue-600 hover:text-blue-800 hover:underline">Michael Rodriguez</a>
                            </div>
                        </td>
                        <td class="py-3 px-4">Feb 12, 2024 14:45</td>
                        <td class="w-0 p-0 relative">
                            <div class="absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-150">
                                <button class="p-1 hover:bg-gray-100 rounded-full" onclick="toggleDropdown(event, this)">
                                    <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 14a2 2 0 100-4 2 2 0 000 4zM19 14a2 2 0 100-4 2 2 0 000 4zM5 14a2 2 0 100-4 2 2 0 000 4z"></path>
                                    </svg>
                                </button>
                                <div class="hidden absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg border z-50 dropdown-menu">
                                    <ul class="py-1" role="menu">
                                        <li role="presentation">
                                            <button class="w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="openEditTagModal(this)">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path>
                                                </svg>
                                                Edit tag
                                            </button>
                                        </li>
                                        <li role="presentation">
                                            <button class="w-full px-4 py-2 text-sm text-red-600 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="deleteTag(this)">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                                Delete tag
                                            </button>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr class="border-b hover:bg-gray-50 group">
                        <td class="py-3 px-4"><input type="checkbox" class="rounded border-gray-300"></td>
                        <td class="py-3 px-4">
                            <div class="flex items-center gap-2">
                                <span class="bg-yellow-100 text-yellow-800 px-2 py-1 rounded-md text-xs">#data-security</span>
                            </div>
                        </td>
                        <td class="py-3 px-4">429</td>
                        <td class="py-3 px-4">
                            <div class="relative">
                                <a href="#" class="text-blue-600 hover:text-blue-800 hover:underline">James Thompson</a>
                            </div>
                        </td>
                        <td class="py-3 px-4">Feb 15, 2024 11:20</td>
                        <td class="w-0 p-0 relative">
                            <div class="absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-150">
                                <button class="p-1 hover:bg-gray-100 rounded-full" onclick="toggleDropdown(event, this)">
                                    <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 14a2 2 0 100-4 2 2 0 000 4zM19 14a2 2 0 100-4 2 2 0 000 4zM5 14a2 2 0 100-4 2 2 0 000 4z"></path>
                                    </svg>
                                </button>
                                <div class="hidden absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg border z-50 dropdown-menu">
                                    <ul class="py-1" role="menu">
                                        <li role="presentation">
                                            <button class="w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="openEditTagModal(this)">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path>
                                                </svg>
                                                Edit tag
                                            </button>
                                        </li>
                                        <li role="presentation">
                                            <button class="w-full px-4 py-2 text-sm text-red-600 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="deleteTag(this)">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                                Delete tag
                                            </button>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr class="border-b hover:bg-gray-50 group">
                        <td class="py-3 px-4"><input type="checkbox" class="rounded border-gray-300"></td>
                        <td class="py-3 px-4">
                            <div class="flex items-center gap-2">
                                <span class="bg-red-100 text-red-800 px-2 py-1 rounded-md text-xs">#compliance</span>
                            </div>
                        </td>
                        <td class="py-3 px-4">1,598</td>
                        <td class="py-3 px-4">
                            <div class="relative">
                                <a href="#" class="text-blue-600 hover:text-blue-800 hover:underline">Olivia Parker</a>
                            </div>
                        </td>
                        <td class="py-3 px-4">Feb 1, 2024 16:55</td>
                        <td class="w-0 p-0 relative">
                            <div class="absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-150">
                                <button class="p-1 hover:bg-gray-100 rounded-full" onclick="toggleDropdown(event, this)">
                                    <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 14a2 2 0 100-4 2 2 0 000 4zM19 14a2 2 0 100-4 2 2 0 000 4zM5 14a2 2 0 100-4 2 2 0 000 4z"></path>
                                    </svg>
                                </button>
                                <div class="hidden absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg border z-50 dropdown-menu">
                                    <ul class="py-1" role="menu">
                                        <li role="presentation">
                                            <button class="w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="openEditTagModal(this)">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path>
                                                </svg>
                                                Edit tag
                                            </button>
                                        </li>
                                        <li role="presentation">
                                            <button class="w-full px-4 py-2 text-sm text-red-600 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="deleteTag(this)">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                                Delete tag
                                            </button>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr class="border-b hover:bg-gray-50 group">
                        <td class="py-3 px-4"><input type="checkbox" class="rounded border-gray-300"></td>
                        <td class="py-3 px-4">
                            <div class="flex items-center gap-2">
                                <span class="bg-indigo-100 text-indigo-800 px-2 py-1 rounded-md text-xs">#data-catalog</span>
                            </div>
                        </td>
                        <td class="py-3 px-4">3,076</td>
                        <td class="py-3 px-4">
                            <div class="relative">
                                <a href="#" class="text-blue-600 hover:text-blue-800 hover:underline">Daniel Kim</a>
                            </div>
                        </td>
                        <td class="py-3 px-4">Feb 13, 2024 13:40</td>
                        <td class="w-0 p-0 relative">
                            <div class="absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-150">
                                <button class="p-1 hover:bg-gray-100 rounded-full" onclick="toggleDropdown(event, this)">
                                    <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 14a2 2 0 100-4 2 2 0 000 4zM19 14a2 2 0 100-4 2 2 0 000 4zM5 14a2 2 0 100-4 2 2 0 000 4z"></path>
                                    </svg>
                                </button>
                                <div class="hidden absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg border z-50 dropdown-menu">
                                    <ul class="py-1" role="menu">
                                        <li role="presentation">
                                            <button class="w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="openEditTagModal(this)">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path>
                                                </svg>
                                                Edit tag
                                            </button>
                                        </li>
                                        <li role="presentation">
                                            <button class="w-full px-4 py-2 text-sm text-red-600 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="deleteTag(this)">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                                Delete tag
                                            </button>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </td>
                    </tr>
                    <tr class="border-b hover:bg-gray-50 group">
                        <td class="py-3 px-4"><input type="checkbox" class="rounded border-gray-300"></td>
                        <td class="py-3 px-4">
                            <div class="flex items-center gap-2">
                                <span class="bg-orange-100 text-orange-800 px-2 py-1 rounded-md text-xs">#data-pipeline</span>
                            </div>
                        </td>
                        <td class="py-3 px-4">1,842</td>
                        <td class="py-3 px-4">
                            <div class="relative">
                                <a href="#" class="text-blue-600 hover:text-blue-800 hover:underline">Lucas Anderson</a>
                            </div>
                        </td>
                        <td class="py-3 px-4">Jan 25, 2024 15:10</td>
                        <td class="w-0 p-0 relative">
                            <div class="absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-150">
                                <button class="p-1 hover:bg-gray-100 rounded-full" onclick="toggleDropdown(event, this)">
                                    <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M12 14a2 2 0 100-4 2 2 0 000 4zM19 14a2 2 0 100-4 2 2 0 000 4zM5 14a2 2 0 100-4 2 2 0 000 4z"></path>
                                    </svg>
                                </button>
                                <div class="hidden absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg border z-50 dropdown-menu">
                                    <ul class="py-1" role="menu">
                                        <li role="presentation">
                                            <button class="w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="openEditTagModal(this)">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path>
                                                </svg>
                                                Edit tag
                                            </button>
                                        </li>
                                        <li role="presentation">
                                            <button class="w-full px-4 py-2 text-sm text-red-600 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="deleteTag(this)">
                                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                                </svg>
                                                Delete tag
                                            </button>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Create/Edit Tag Modal -->
    <div id="createTagModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-lg shadow-xl w-[480px] max-w-full">
            <div class="flex items-center justify-between px-6 py-4 border-b">
                <div class="flex items-center gap-3">
                    <h3 id="modalTitle" class="text-xl font-medium text-gray-900">Create a new tag</h3>
                </div>
                <button onclick="closeCreateTagModal()" class="text-gray-400 hover:text-gray-500">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M6.225 4.811a1 1 0 00-1.414 1.414L10.586 12 4.81 17.775a1 1 0 101.414 1.414L12 13.414l5.775 5.775a1 1 0 001.414-1.414L13.414 12l5.775-5.775a1 1 0 00-1.414-1.414L12 10.586 6.225 4.81z"></path>
                    </svg>
                </button>
            </div>
            <form onsubmit="handleTagSubmit(event)" class="p-6">
                <input type="hidden" id="editMode" value="create">
                <input type="hidden" id="originalTagName" value="">
                <div class="space-y-4">
                    <!-- Name Field -->
                    <div>
                        <label for="tagName" class="block text-sm font-medium text-gray-700 mb-1">Name</label>
                        <div>
                            <div class="relative">
                                <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                                    <span class="text-gray-500">#</span>
                                </div>
                                <input type="text" id="tagName" name="tagName" required
                                    oninput="validateTagName(this.value)"
                                    class="w-full pl-7 pr-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
                            </div>
                            <div id="tagError" class="hidden mt-1 text-sm text-red-600">This tag already exists</div>
                        </div>
                    </div>
                    
                    <!-- Color Field -->
                    <div>
                        <label for="tagColor" class="block text-sm font-medium text-gray-700 mb-1">Bucket Color</label>
                        <div class="relative">
                            <button type="button" 
                                onclick="toggleColorDropdown()"
                                class="w-full h-10 bg-gray-100 border rounded flex items-center px-3 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 cursor-default">
                                <div id="selectedColorPreview" class="flex items-center gap-2">
                                    <div class="w-4 h-4 rounded hidden" id="selectedColorSwatch"></div>
                                    <span id="selectedColor" class="text-gray-500">Select color</span>
                                </div>
                                <div class="flex-shrink-0 ml-auto">
                                    <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </div>
                            </button>

                            <!-- Color Dropdown -->
                            <div id="colorDropdown" class="hidden absolute left-0 top-full mt-1 w-full bg-white rounded-md shadow-lg border z-50">
                                <div class="max-h-[240px] overflow-y-auto py-1">
                                    <div class="px-3 py-2 hover:bg-gray-50 cursor-pointer flex items-center gap-2" onclick="selectColor('Blue', 'bg-blue-100', 'text-blue-800', '#4B6BFB')">
                                        <div class="w-4 h-4 bg-[#4B6BFB] rounded"></div>
                                        <span class="text-sm text-gray-700">Blue</span>
                                    </div>
                                    <div class="px-3 py-2 hover:bg-gray-50 cursor-pointer flex items-center gap-2" onclick="selectColor('Light Blue', 'bg-sky-100', 'text-sky-800', '#36B7FF')">
                                        <div class="w-4 h-4 bg-[#36B7FF] rounded"></div>
                                        <span class="text-sm text-gray-700">Light Blue</span>
                                    </div>
                                    <div class="px-3 py-2 hover:bg-gray-50 cursor-pointer flex items-center gap-2" onclick="selectColor('Green', 'bg-green-100', 'text-green-800', '#1EC71E')">
                                        <div class="w-4 h-4 bg-[#1EC71E] rounded"></div>
                                        <span class="text-sm text-gray-700">Green</span>
                                    </div>
                                    <div class="px-3 py-2 hover:bg-gray-50 cursor-pointer flex items-center gap-2" onclick="selectColor('Light Green', 'bg-lime-100', 'text-lime-800', '#7FBA23')">
                                        <div class="w-4 h-4 bg-[#7FBA23] rounded"></div>
                                        <span class="text-sm text-gray-700">Light Green</span>
                                    </div>
                                    <div class="px-3 py-2 hover:bg-gray-50 cursor-pointer flex items-center gap-2" onclick="selectColor('Orange', 'bg-orange-100', 'text-orange-800', '#FF8B3B')">
                                        <div class="w-4 h-4 bg-[#FF8B3B] rounded"></div>
                                        <span class="text-sm text-gray-700">Orange</span>
                                    </div>
                                    <div class="px-3 py-2 hover:bg-gray-50 cursor-pointer flex items-center gap-2" onclick="selectColor('Purple', 'bg-purple-100', 'text-purple-800', '#8B54F7')">
                                        <div class="w-4 h-4 bg-[#8B54F7] rounded"></div>
                                        <span class="text-sm text-gray-700">Purple</span>
                                    </div>
                                    <div class="px-3 py-2 hover:bg-gray-50 cursor-pointer flex items-center gap-2" onclick="selectColor('Red', 'bg-red-100', 'text-red-800', '#F93E3E')">
                                        <div class="w-4 h-4 bg-[#F93E3E] rounded"></div>
                                        <span class="text-sm text-gray-700">Red</span>
                                    </div>
                                    <div class="px-3 py-2 hover:bg-gray-50 cursor-pointer flex items-center gap-2" onclick="selectColor('Yellow', 'bg-yellow-100', 'text-yellow-800', '#FFC700')">
                                        <div class="w-4 h-4 bg-[#FFC700] rounded"></div>
                                        <span class="text-sm text-gray-700">Yellow</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Hidden input to store the selected color value -->
                            <input type="hidden" id="tagColor" name="tagColor" required>
                        </div>
                    </div>
                </div>
                
                <!-- Submit Button -->
                <div class="mt-6">
                    <button type="submit" id="createTagButton"
                        class="w-full flex items-center justify-center gap-2 rounded text-xs leading-5 font-medium tracking-[1px] uppercase text-white bg-[#1ec71e] hover:bg-[#1ab01a] active:bg-[#158515] px-4 py-2.5 h-10 cursor-pointer border-none disabled:bg-[#edf0f5] disabled:cursor-not-allowed disabled:border-none disabled:shadow-none disabled:opacity-65 disabled:hover:bg-[#edf0f5] disabled:text-[rgba(124,133,148,0.7)]">
                        Create a new tag
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Tag Administration Table Bulk Selection
        const headerCheckbox = document.querySelector('thead input[type="checkbox"]');
        const rowCheckboxes = document.querySelectorAll('tbody input[type="checkbox"]');

        // Sorting state
        let currentSortColumn = null;
        let currentSortDirection = 'none'; // 'none', 'asc', 'desc'

        // Handle header checkbox change
        headerCheckbox.addEventListener('change', function() {
            const isChecked = this.checked;
            rowCheckboxes.forEach(checkbox => {
                checkbox.checked = isChecked;
                updateRowSelection(checkbox);
            });
        });

        // Handle individual checkbox changes
        rowCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                updateRowSelection(this);
                updateHeaderCheckbox();
            });
        });

        // Update row styling when selected
        function updateRowSelection(checkbox) {
            const row = checkbox.closest('tr');
            if (checkbox.checked) {
                row.classList.add('bg-blue-50');
            } else {
                row.classList.remove('bg-blue-50');
            }
        }

        // Update header checkbox state based on row checkboxes
        function updateHeaderCheckbox() {
            const totalCheckboxes = rowCheckboxes.length;
            const checkedCheckboxes = Array.from(rowCheckboxes).filter(cb => cb.checked).length;
            
            headerCheckbox.checked = checkedCheckboxes > 0;
            headerCheckbox.indeterminate = checkedCheckboxes > 0 && checkedCheckboxes < totalCheckboxes;
        }

        // Sorting functionality
        function sortTable(columnIndex, type) {
            const table = document.querySelector('table');
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));
            const headers = table.querySelectorAll('th button .sort-icon');

            // Reset all sort icons except the current one
            headers.forEach((icon, index) => {
                if (index + 1 !== columnIndex) {
                    icon.style.transform = '';
                    icon.style.opacity = '0.5';
                }
            });

            // Update sort direction
            if (currentSortColumn === columnIndex) {
                if (currentSortDirection === 'none' || currentSortDirection === 'desc') {
                    currentSortDirection = 'asc';
                    headers[columnIndex - 1].style.transform = 'rotate(180deg)';
                } else {
                    currentSortDirection = 'desc';
                    headers[columnIndex - 1].style.transform = '';
                }
            } else {
                currentSortColumn = columnIndex;
                currentSortDirection = 'desc';
                headers[columnIndex - 1].style.transform = '';
            }

            headers[columnIndex - 1].style.opacity = '1';

            // Sort the rows
            rows.sort((a, b) => {
                let aValue, bValue;
                
                if (type === 'number') {
                    // Remove commas and convert to numbers
                    aValue = parseInt(a.cells[columnIndex].textContent.replace(/,/g, ''));
                    bValue = parseInt(b.cells[columnIndex].textContent.replace(/,/g, ''));
                } else if (type === 'date') {
                    // Convert dates to timestamps
                    aValue = new Date(a.cells[columnIndex].textContent).getTime();
                    bValue = new Date(b.cells[columnIndex].textContent).getTime();
                } else if (type === 'text') {
                    if (columnIndex === 1) {
                        // For tag names
                        aValue = a.cells[columnIndex].querySelector('span').textContent.trim();
                        bValue = b.cells[columnIndex].querySelector('span').textContent.trim();
                    } else {
                        // For creator names
                        aValue = a.cells[columnIndex].querySelector('a').textContent.trim();
                        bValue = b.cells[columnIndex].querySelector('a').textContent.trim();
                    }
                }

                if (currentSortDirection === 'asc') {
                    return aValue > bValue ? 1 : -1;
                } else {
                    return aValue < bValue ? 1 : -1;
                }
            });

            // Reorder the rows in the table
            rows.forEach(row => tbody.appendChild(row));
        }

        // Email copy functionality
        function copyEmail(email) {
            navigator.clipboard.writeText(email).then(() => {
                const button = event.target;
                const originalText = button.textContent;
                button.textContent = 'COPIED!';
                setTimeout(() => {
                    button.textContent = originalText;
                }, 1000);
            });
        }

        // Update the dropdown menu function
        function toggleDropdown(event, button) {
            event.stopPropagation();
            
            // Close all other dropdowns first
            document.querySelectorAll('.dropdown-menu').forEach(dropdown => {
                if (dropdown !== button.nextElementSibling) {
                    dropdown.classList.add('hidden');
                    const otherContainer = dropdown.closest('.opacity-100');
                    if (otherContainer) {
                        otherContainer.classList.remove('opacity-100');
                        otherContainer.classList.add('opacity-0');
                    }
                }
            });
            
            const dropdown = button.nextElementSibling;
            const isHidden = dropdown.classList.contains('hidden');
            const container = button.closest('.opacity-0, .opacity-100');
            
            // Show this dropdown
            if (isHidden) {
                dropdown.classList.remove('hidden');
                
                // Make the button and menu visible
                if (container) {
                    container.classList.remove('opacity-0');
                    container.classList.add('opacity-100');
                }
                
                // Close dropdown when clicking outside
                const closeDropdown = (e) => {
                    if (!dropdown.contains(e.target) && !button.contains(e.target)) {
                        dropdown.classList.add('hidden');
                        if (container) {
                            container.classList.remove('opacity-100');
                            container.classList.add('opacity-0');
                        }
                        document.removeEventListener('click', closeDropdown);
                    }
                };
                
                // Add the event listener with a slight delay to avoid immediate trigger
                setTimeout(() => {
                    document.addEventListener('click', closeDropdown);
                }, 0);
            } else {
                dropdown.classList.add('hidden');
                if (container) {
                    container.classList.remove('opacity-100');
                    container.classList.add('opacity-0');
                }
            }
        }

        // Add helper function to escape regex special characters
        function escapeRegExp(string) {
            return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }

        // Update tag filtering function with highlighting
        function filterTags(query) {
            query = query.toLowerCase();
            const rows = document.querySelectorAll('tbody tr');
            
            rows.forEach(row => {
                const tagSpan = row.querySelector('td:nth-child(2) span');
                const tagText = tagSpan.textContent;
                
                if (query && tagText.toLowerCase().includes(query)) {
                    row.style.display = '';
                    // Create regex with the escaped query for case-insensitive matching
                    const regex = new RegExp(`(${escapeRegExp(query)})`, 'gi');
                    // Replace matching parts with highlighted spans
                    const highlightedText = tagText.replace(regex, '<mark class="bg-blue-100">$1</mark>');
                    tagSpan.innerHTML = highlightedText;
                } else {
                    if (query) {
                        row.style.display = 'none';
                    } else {
                        // If query is empty, show all rows and remove highlighting
                        row.style.display = '';
                        tagSpan.textContent = tagText;
                    }
                }
            });
        }

        function openCreateTagModal() {
            const modal = document.getElementById('createTagModal');
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            document.body.style.overflow = 'hidden';
        }

        function closeCreateTagModal() {
            const modal = document.getElementById('createTagModal');
            modal.classList.add('hidden');
            modal.classList.remove('flex');
            document.body.style.overflow = '';
        }

        function validateTagName(value) {
            const editMode = document.getElementById('editMode').value;
            const originalName = document.getElementById('originalTagName').value;
            const existingTags = Array.from(document.querySelectorAll('tbody td:nth-child(2) span')).map(span => 
                span.textContent.trim().toLowerCase()
            );
            
            // Format the input value to match tag format
            const formattedValue = value.startsWith('#') ? value.toLowerCase() : `#${value.toLowerCase()}`;
            
            const tagError = document.getElementById('tagError');
            const submitButton = document.getElementById('createTagButton');
            
            // In edit mode, allow the original name
            if (editMode === 'edit' && formattedValue === originalName.toLowerCase()) {
                tagError.classList.add('hidden');
                submitButton.disabled = false;
                return;
            }
            
            if (existingTags.includes(formattedValue)) {
                tagError.classList.remove('hidden');
                submitButton.disabled = true;
            } else {
                tagError.classList.add('hidden');
                submitButton.disabled = false;
            }
        }

        function openEditTagModal(button) {
            const row = button.closest('tr');
            const tagSpan = row.querySelector('td:nth-child(2) span');
            const tagName = tagSpan.textContent;
            const tagClasses = tagSpan.className;
            
            // Set edit mode
            document.getElementById('editMode').value = 'edit';
            document.getElementById('originalTagName').value = tagName;
            document.getElementById('modalTitle').textContent = 'Edit tag';
            
            // Set tag name - remove the # prefix for the input
            const tagNameInput = document.getElementById('tagName');
            tagNameInput.value = tagName.replace('#', '');
            
            // Find and set color based on classes
            const colorMap = {
                'bg-blue-100 text-blue-800': 'Blue',
                'bg-green-100 text-green-800': 'Green',
                'bg-lime-100 text-lime-800': 'Light Green',
                'bg-red-100 text-red-800': 'Red',
                'bg-violet-100 text-violet-800': 'Violet',
                'bg-orange-100 text-orange-800': 'Orange'
            };
            
            for (const [classes, colorName] of Object.entries(colorMap)) {
                if (tagClasses.includes(classes.split(' ')[0])) {
                    selectColor(colorName, classes.split(' ')[0], classes.split(' ')[1]);
                    break;
                }
            }
            
            // Update button text
            const submitButton = document.getElementById('createTagButton');
            submitButton.textContent = 'Save changes';
            
            // Open modal
            openCreateTagModal();
        }

        function handleTagSubmit(event) {
            event.preventDefault();
            
            // Capture all form data first
            const editMode = document.getElementById('editMode').value;
            const name = document.getElementById('tagName').value;
            const colorInput = document.getElementById('tagColor');
            const bgClass = colorInput.dataset.bgClass;
            const textClass = colorInput.dataset.textClass;
            const originalName = document.getElementById('originalTagName').value;
            
            // Ensure the name starts with # and is lowercase
            const tagName = name.toLowerCase();
            const formattedTagName = tagName.startsWith('#') ? tagName : `#${tagName}`;

            // Close modal and reset form immediately
            closeCreateTagModal();
            resetModalForm();
            
            if (editMode === 'edit') {
                // Find and update existing tag
                const rows = document.querySelectorAll('tbody tr');
                
                rows.forEach(row => {
                    const tagSpan = row.querySelector('td:nth-child(2) span');
                    if (tagSpan.textContent.toLowerCase() === originalName.toLowerCase()) {
                        tagSpan.textContent = formattedTagName;
                        tagSpan.className = `${bgClass} ${textClass} px-2 py-1 rounded-md text-xs`;
                    }
                });
            } else {
                // Create new tag
                const tbody = document.querySelector('tbody');
                const newRow = document.createElement('tr');
                newRow.className = 'border-b hover:bg-gray-50 group';
                
                // Get current date in the same format as existing rows
                const now = new Date();
                const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                const formattedDate = `${months[now.getMonth()]} ${now.getDate()}, ${now.getFullYear()} ${String(now.getHours()).padStart(2, '0')}:${String(now.getMinutes()).padStart(2, '0')}`;
                
                // Generate random creator name from a list
                const creators = ['Sarah Chen', 'Emma Wilson', 'Michael Rodriguez', 'James Thompson', 'Olivia Parker', 'Daniel Kim', 'Sophie Martin', 'Lucas Anderson', 'Isabella Garcia', 'Alexander Lee'];
                const randomCreator = creators[Math.floor(Math.random() * creators.length)];
                
                // Generate random object count between 100 and 3500
                const randomCount = Math.floor(Math.random() * (3500 - 100 + 1) + 100);
                const formattedCount = randomCount.toLocaleString();
                
                newRow.innerHTML = `
                    <td class="py-3 px-4"><input type="checkbox" class="rounded border-gray-300"></td>
                    <td class="py-3 px-4">
                        <div class="flex items-center gap-2">
                            <span class="${bgClass} ${textClass} px-2 py-1 rounded-md text-xs">${formattedTagName}</span>
                        </div>
                    </td>
                    <td class="py-3 px-4">${formattedCount}</td>
                    <td class="py-3 px-4">
                        <div class="relative">
                            <a href="#" class="text-blue-600 hover:text-blue-800 hover:underline">${randomCreator}</a>
                        </div>
                    </td>
                    <td class="py-3 px-4">${formattedDate}</td>
                    <td class="w-0 p-0 relative">
                        <div class="absolute right-4 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 transition-opacity duration-150">
                            <button class="p-1 hover:bg-gray-100 rounded-full" onclick="toggleDropdown(event, this)">
                                <svg class="w-5 h-5 text-gray-400" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 14a2 2 0 100-4 2 2 0 000 4zM19 14a2 2 0 100-4 2 2 0 000 4zM5 14a2 2 0 100-4 2 2 0 000 4z"></path>
                                </svg>
                            </button>
                            <div class="hidden absolute right-0 mt-1 w-48 bg-white rounded-md shadow-lg border z-50 dropdown-menu">
                                <ul class="py-1" role="menu">
                                    <li role="presentation">
                                        <button class="w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="openEditTagModal(this)">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path>
                                            </svg>
                                            Edit tag
                                        </button>
                                    </li>
                                    <li role="presentation">
                                        <button class="w-full px-4 py-2 text-sm text-red-600 hover:bg-gray-100 flex items-center gap-2" role="menuitem" onclick="deleteTag(this)">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                            </svg>
                                            Delete tag
                                        </button>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </td>
                `;
                
                // Insert the new row at the beginning of the table
                tbody.insertBefore(newRow, tbody.firstChild);
                
                // Add event listeners for the new checkbox
                const checkbox = newRow.querySelector('input[type="checkbox"]');
                
                // Update the rowCheckboxes NodeList to include the new checkbox
                rowCheckboxes = document.querySelectorAll('tbody input[type="checkbox"]');
                
                // Add event listener to the new checkbox
                checkbox.addEventListener('change', function() {
                    updateRowSelection(this);
                    updateHeaderCheckbox();
                });
                
                // If header checkbox is checked, check the new checkbox too
                if (headerCheckbox.checked) {
                    checkbox.checked = true;
                    updateRowSelection(checkbox);
                }
            }
        }

        function resetModalForm() {
            const form = document.querySelector('#createTagModal form');
            form.reset();
            document.getElementById('editMode').value = 'create';
            document.getElementById('originalTagName').value = '';
            document.getElementById('modalTitle').textContent = 'Create a new tag';
            document.getElementById('selectedColor').textContent = 'Select color';
            document.getElementById('selectedColorSwatch').classList.add('hidden');
            document.getElementById('tagError').classList.add('hidden');
            document.getElementById('createTagButton').textContent = 'Create a new tag';
            document.getElementById('createTagButton').disabled = false;
        }

        function toggleColorDropdown() {
            const dropdown = document.getElementById('colorDropdown');
            dropdown.classList.toggle('hidden');

            // Close dropdown when clicking outside
            if (!dropdown.classList.contains('hidden')) {
                const closeDropdown = (e) => {
                    if (!dropdown.contains(e.target) && e.target.id !== 'selectedColor') {
                        dropdown.classList.add('hidden');
                        document.removeEventListener('click', closeDropdown);
                    }
                };
                
                // Add the event listener with a slight delay
                setTimeout(() => {
                    document.addEventListener('click', closeDropdown);
                }, 0);
            }
        }

        function selectColor(colorName, bgClass, textClass, hexColor) {
            const selectedColorSpan = document.getElementById('selectedColor');
            const selectedColorSwatch = document.getElementById('selectedColorSwatch');
            const hiddenInput = document.getElementById('tagColor');
            const dropdown = document.getElementById('colorDropdown');
            
            selectedColorSpan.textContent = colorName;
            selectedColorSwatch.style.backgroundColor = hexColor;
            selectedColorSwatch.classList.remove('hidden');
            hiddenInput.value = colorName.toLowerCase();
            
            // Store the classes for tag creation
            hiddenInput.dataset.bgClass = bgClass;
            hiddenInput.dataset.textClass = textClass;
            hiddenInput.dataset.hexColor = hexColor;
            
            dropdown.classList.add('hidden');
        }

        // Close modal when clicking outside
        document.getElementById('createTagModal').addEventListener('click', function(event) {
            if (event.target === this) {
                closeCreateTagModal();
            }
        });

        // Update the headerCheckbox event listener to handle dynamic checkboxes
        function updateHeaderCheckboxEventListener() {
            headerCheckbox.addEventListener('change', function() {
                const isChecked = this.checked;
                // Get fresh NodeList of all checkboxes
                const currentRowCheckboxes = document.querySelectorAll('tbody input[type="checkbox"]');
                currentRowCheckboxes.forEach(checkbox => {
                    checkbox.checked = isChecked;
                    updateRowSelection(checkbox);
                });
            });
        }

        // Call this when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            updateHeaderCheckboxEventListener();
        });

        function deleteTag(button) {
            const row = button.closest('tr');
            row.remove();
            
            // Update header checkbox state after deletion
            updateHeaderCheckbox();
        }
    </script>

    <style>
        /* Animation Keyframes */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        @keyframes scaleIn {
            from { transform: scale(0.98); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        /* Hover Animations */
        .hover\:bg-gray-50 {
            transition: background-color 100ms ease-in-out;
        }

        .hover\:opacity-90 {
            transition: opacity 100ms ease-in-out;
        }

        /* Sort icon transitions */
        .sort-icon {
            transition: transform 0.2s ease-in-out, opacity 0.2s ease-in-out;
            opacity: 0.5;
        }

        th button:hover .sort-icon {
            opacity: 0.75;
        }

        /* Dropdown menu animations */
        .absolute .hidden {
            display: none;
            opacity: 0;
            transition: opacity 100ms ease-out;
        }

        .absolute div:not(.hidden) {
            display: block;
            opacity: 1;
            animation: dropdownFadeIn 100ms ease-out;
        }

        @keyframes dropdownFadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        /* Update dropdown menu animations */
        .dropdown-menu {
            transform-origin: top right;
        }

        .dropdown-menu:not(.hidden) {
            display: block;
            animation: dropdownFadeIn 100ms ease-out forwards;
        }

        /* Update the container to maintain visibility when menu is open */
        .opacity-100 {
            opacity: 1 !important;
        }
    </style>
</body>
</html> 